# vim: filetype=sh

APP_DIR='/Applications'

# Used for mvim script
export VIM_APP_DIR=$APP_DIR

# Run Byobu from the Homebrew path
export BYOBU_PREFIX=$(brew --prefix)

# Install Casks to /Applications instead of ~/Applications
export HOMEBREW_CASK_OPTS="--appdir=${APP_DIR}"

# pip --user installs
export PATH=~/Library/Python/2.7/bin:$PATH

# Use GNU tools without the g prefix
packages=(
  'coreutils'
  'getopt'
  'gnu-sed'
)
for package in "${packages[@]}"; do
  path="/usr/local/opt/${package}/libexec"
  if [ -d $path ]; then
    export PATH="${path}/gnubin:${PATH}"
    export MANPATH="${path}/gnuman:${PATH}"
  fi
done

# Function to remove a Homebrew package and all its dependencies
brew_clean() {
  for formula in "$@"; do
    echo "Removing ${formula} and dependencies..."
    brew uninstall $formula
    if [ "$(brew deps ${formula})" ]; then
      # orphaned packages && formula dependencies
      brew uninstall $(join <(brew leaves) <(brew deps "${formula}"))
    fi
  done
}
alias 'brew-clean'=brew_clean
